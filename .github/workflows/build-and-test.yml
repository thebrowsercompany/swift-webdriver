name: Build & Test

on: [push, workflow_dispatch]

jobs:
  build:
    runs-on: windows-2022
    timeout-minutes: 20

    steps:
      - run: |
          $SDKRoot = "$env:GITHUB_WORKSPACE\BuildRoot\Library\Developer\SDKs\Windows.sdk"
          Add-Content $env:GITHUB_ENV "SDKROOT=$SDKRoot"
          
          $PathEntries = @(
            "$SDKRoot\usr\bin",
            "$env:GITHUB_WORKSPACE\BuildRoot\Library\Developer\Toolchains\unknown-Asserts-development.xctoolchain\usr\bin"
          )
          Add-Content $env:GITHUB_PATH ($PathEntries -join ";")

      - run: |
          Write-Output "SDKROOT=$env:SDKROOT"
          Write-Output "Path=$env:Path"
